<div class="registro-container">
  
  <header class="registro-header">
    <a routerLink="/dashboard" class="logo-link">
      <span class="logo-icon">ğŸ“</span>
      <span class="logo-text">OcorrÃªncias Escolares</span>
    </a>
    <div class="header-actions">
      <button class="btn-admin" *ngIf="isAdmin" routerLink="/admin">
        âš™ï¸ Admin
      </button>
      <button class="btn-voltar" (click)="voltar()">â† Voltar</button>
    </div>
  </header>
  
  <main class="registro-content">
    <div class="page-header">
      <h1>Registrar OcorrÃªncia</h1>
      <p>Preencha todos os campos obrigatÃ³rios para registrar uma nova ocorrÃªncia</p>
    </div>

    <form [formGroup]="ocorrenciaForm" (ngSubmit)="onSubmit()">
      
      <div class="form-row">
        <div class="form-group">
          <label for="nomeAluno">Nome do Aluno *</label>
          <input 
            type="text" 
            id="nomeAluno" 
            formControlName="nomeAluno"
            placeholder="Digite o nome completo do aluno"
          >
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="tipoEnsino">Tipo de Ensino *</label>
          <select 
            id="tipoEnsino" 
            formControlName="tipoEnsino"
            (change)="onTipoEnsinoChange($any($event.target).value)"
          >
            <option value="">Selecione</option>
            <option *ngFor="let tipo of tiposEnsino" [value]="tipo">
              {{ tipo }}
            </option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="turma">Turma *</label>
          <select 
            id="turma" 
            formControlName="turma"
            [disabled]="turmasFiltradas.length === 0"
          >
            <option value="">Selecione</option>
            <option *ngFor="let turma of turmasFiltradas" [value]="turma">
              {{ turma }}
            </option>
          </select>
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group form-group-full">
          <label>Tipos de OcorrÃªncia * <span class="hint">(Selecione um ou mais)</span></label>
          <div class="checkbox-grid">
            <label *ngFor="let tipo of tiposOcorrencia" class="checkbox-item">
              <input 
                type="checkbox" 
                [checked]="isTipoSelecionado(tipo)"
                (change)="toggleTipoOcorrencia(tipo)">
              <span>{{ tipo }}</span>
            </label>
          </div>
          <div class="selected-count" *ngIf="tiposSelecionados.length > 0">
            {{ tiposSelecionados.length }} tipo(s) selecionado(s)
          </div>
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="data">Data da OcorrÃªncia *</label>
          <input 
            type="date" 
            id="data" 
            formControlName="data"
          >
        </div>
        
        <div class="form-group">
          <label for="disciplina">Disciplina *</label>
          <select id="disciplina" formControlName="disciplina">
            <option value="">Selecione</option>
            <option *ngFor="let disc of disciplinas" [value]="disc">
              {{ disc }}
            </option>
          </select>
        </div>
      </div>
      
      <div class="form-group">
        <label for="descricao">DescriÃ§Ã£o *</label>
        <textarea 
          id="descricao" 
          formControlName="descricao"
          rows="5"
          placeholder="Descreva detalhadamente o que aconteceu (mÃ­nimo 10 caracteres)"
        ></textarea>
      </div>
      
      <button 
        type="submit" 
        class="btn-submit" 
        [disabled]="ocorrenciaForm.invalid || loading"
      >
        {{ loading ? 'Registrando...' : 'Registrar OcorrÃªncia' }}
      </button>
      
    </form>
  </main>
  
  <div class="modal-overlay" *ngIf="showConfirm" (click)="cancelarEnvio()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h3>Confirmar Registro</h3>
      <p>
        VocÃª tem certeza que deseja registrar esta ocorrÃªncia?<br>
        <strong>Um email serÃ¡ enviado Ã  direÃ§Ã£o da escola.</strong>
      </p>
      
      <div class="modal-actions">
        <button class="btn-cancel" (click)="cancelarEnvio()">
          Cancelar
        </button>
        <button class="btn-confirm" (click)="confirmarEnvio()">
          Confirmar
        </button>
      </div>
    </div>
  </div>
  
</div>
