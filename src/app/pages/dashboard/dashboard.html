<div class="dashboard-container">
  <header class="dashboard-header">
    <a routerLink="/" class="logo-link">
      <span class="logo-icon">ğŸ“</span>
      <span class="logo-text">OcorrÃªncias Escolares</span>
    </a>
    <div class="header-right">
      <div class="user-info">
        <span class="user-name">{{ userName }}</span>
        <span class="user-email">{{ userEmail }}</span>
      </div>
      <button class="btn-admin" *ngIf="isAdmin" routerLink="/admin">
        âš™ï¸ Painel Admin
      </button>
      <button class="btn-logout" (click)="logout()">
        Sair
      </button>
    </div>
  </header>

  <main class="dashboard-content">
    <h1 class="page-title">{{ userRole === 'professor' ? 'AÃ§Ãµes RÃ¡pidas' : 'Painel de GestÃ£o' }}</h1>
    
    <div class="loading" *ngIf="loading">
      <p>Carregando...</p>
    </div>
    
    <!-- Cards para Professor -->
    <div class="action-cards" *ngIf="!loading && userRole === 'professor'">
      <div class="card" (click)="goToRegistro()">
        <div class="card-icon">ğŸ“</div>
        <h3>Registrar OcorrÃªncia</h3>
        <p>Registre uma nova ocorrÃªncia de aluno</p>
      </div>
      
      <div class="card" (click)="goToOcorrencias()">
        <div class="card-icon">ğŸ“‹</div>
        <h3>Minhas OcorrÃªncias</h3>
        <p>Visualize suas ocorrÃªncias registradas</p>
      </div>

      <div class="card" (click)="goToAgendamento()">
        <div class="card-icon">ğŸ“…</div>
        <h3>Agendar Equipamentos</h3>
        <p>Reserve tablet, notebook ou sala de informÃ¡tica</p>
      </div>
    </div>
    
    <!-- Dashboard para CoordenaÃ§Ã£o/DireÃ§Ã£o -->
    <div *ngIf="!loading && (userRole === 'coordenacao' || userRole === 'direcao')">

      <!-- AÃ§Ãµes RÃ¡pidas -->
      <div class="action-cards">
        <div class="card" (click)="goToRegistro()">
          <div class="card-icon">ğŸ“</div>
          <h3>Registrar OcorrÃªncia</h3>
          <p>Registre uma nova ocorrÃªncia de aluno</p>
        </div>
        
        <div class="card card-highlight" (click)="goToOcorrencias()">
          <div class="card-icon">ğŸ“‹</div>
          <h3>Todas as OcorrÃªncias</h3>
          <p>Visualize todas as ocorrÃªncias da escola</p>
        </div>

        <div class="card card-export" (click)="exportarExcel()" *ngIf="estatisticas">
          <div class="card-icon">ğŸ“¤</div>
          <h3>Exportar RelatÃ³rio</h3>
          <p>Baixe o relatÃ³rio completo em Excel</p>
        </div>
      </div>

      <!-- Filtros de PerÃ­odo -->
      <div class="filtros-periodo" *ngIf="estatisticas">
        <h2 class="filtros-titulo">ğŸ“Š AnÃ¡lise de PerÃ­odo</h2>
        <div class="filtros-container">
          <div class="filtro-botoes">
            <button 
              class="btn-filtro" 
              [class.active]="periodoSelecionado === 'semana'"
              (click)="periodoSelecionado = 'semana'; aplicarFiltroPeriodo()">
              Ãšltima Semana
            </button>
            <button 
              class="btn-filtro" 
              [class.active]="periodoSelecionado === 'mes'"
              (click)="periodoSelecionado = 'mes'; aplicarFiltroPeriodo()">
              Ãšltimo MÃªs
            </button>
            <button 
              class="btn-filtro" 
              [class.active]="periodoSelecionado === 'trimestre'"
              (click)="periodoSelecionado = 'trimestre'; aplicarFiltroPeriodo()">
              Ãšltimo Trimestre
            </button>
            <button 
              class="btn-filtro" 
              [class.active]="periodoSelecionado === 'semestre'"
              (click)="periodoSelecionado = 'semestre'; aplicarFiltroPeriodo()">
              Ãšltimo Semestre
            </button>
            <button 
              class="btn-filtro" 
              [class.active]="periodoSelecionado === 'customizado'"
              (click)="periodoSelecionado = 'customizado'">
              PerÃ­odo Customizado
            </button>
          </div>

          <!-- Filtro Customizado -->
          <div class="filtro-customizado" *ngIf="periodoSelecionado === 'customizado'">
            <div class="data-inputs">
              <div class="input-group">
                <label>Data InÃ­cio:</label>
                <input 
                  type="date" 
                  [(ngModel)]="dataInicio"
                  (change)="aplicarFiltroPeriodo()">
              </div>
              <div class="input-group">
                <label>Data Fim:</label>
                <input 
                  type="date" 
                  [(ngModel)]="dataFim"
                  (change)="aplicarFiltroPeriodo()">
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- GrÃ¡ficos -->
      <div class="charts-grid" *ngIf="estatisticas && !loadingEstatisticas">
        
        <!-- GrÃ¡fico de Linha - TendÃªncia -->
        <div class="chart-container">
          <canvas baseChart
            [data]="lineChartData"
            [options]="lineChartOptions"
            type="line">
          </canvas>
        </div>

        <!-- GrÃ¡fico de Barras - Top Turmas -->
        <div class="chart-container">
          <canvas baseChart
            [data]="barChartData"
            [options]="barChartOptions"
            type="bar">
          </canvas>
        </div>

        <!-- Top 10 Alunos -->
        <div class="chart-container top-alunos" *ngIf="estatisticas.topAlunos.length > 0">
          <h3 class="chart-title">Top 10 Alunos com Mais OcorrÃªncias</h3>
          <div class="top-list">
            <div class="top-item" *ngFor="let aluno of estatisticas.topAlunos; let i = index">
              <span class="rank">{{ i + 1 }}Âº</span>
              <span class="name">{{ aluno.nome }}</span>
              <span class="badge-count">{{ aluno.quantidade }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="loading" *ngIf="loadingEstatisticas">
        <p>Carregando estatÃ­sticas...</p>
      </div>
    </div>
  </main>
</div>